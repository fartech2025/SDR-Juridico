import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
import { useTeamsSync } from '@/hooks/useTeamsSync';
import { RefreshCw, Link2, CheckCircle, AlertCircle } from 'lucide-react';
export function TeamsIntegrationWidget() {
    const { isConnected, isLoading, error, lastSync, eventCount, link, sync, refresh } = useTeamsSync();
    return (_jsxs("div", { className: "bg-white border border-gray-200 rounded-lg p-6 space-y-4", children: [_jsxs("div", { className: "flex items-center justify-between", children: [_jsxs("div", { children: [_jsx("h3", { className: "text-lg font-semibold text-gray-900", children: "Microsoft Teams" }), _jsx("p", { className: "text-sm text-gray-500 mt-1", children: "Integre suas reuni\u00F5es do Teams com a agenda" })] }), _jsx("div", { className: "text-3xl", children: "\uD83D\uDD17" })] }), _jsxs("div", { className: "bg-gray-50 rounded-lg p-4 space-y-2", children: [isConnected ? (_jsxs("div", { className: "flex items-center gap-2 text-green-600", children: [_jsx(CheckCircle, { size: 20 }), _jsx("span", { className: "font-medium", children: "Conectado ao Teams" })] })) : (_jsxs("div", { className: "flex items-center gap-2 text-yellow-600", children: [_jsx(AlertCircle, { size: 20 }), _jsx("span", { className: "font-medium", children: "N\u00E3o conectado" })] })), lastSync && (_jsxs("p", { className: "text-xs text-gray-600", children: ["\u00DAltima sincroniza\u00E7\u00E3o: ", new Date(lastSync).toLocaleString('pt-BR')] })), eventCount > 0 && (_jsxs("p", { className: "text-xs text-gray-600", children: [eventCount, " evento", eventCount !== 1 ? 's' : '', " sincronizado", eventCount !== 1 ? 's' : ''] }))] }), _jsx("div", { className: "flex gap-2", children: !isConnected ? (_jsxs("button", { onClick: link, disabled: isLoading, className: "flex-1 flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed font-medium transition", children: [_jsx(Link2, { size: 18 }), isLoading ? 'Conectando...' : 'Conectar ao Teams'] })) : (_jsxs(_Fragment, { children: [_jsxs("button", { onClick: sync, disabled: isLoading, className: "flex-1 flex items-center justify-center gap-2 bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed font-medium transition", children: [_jsx(RefreshCw, { size: 18, className: isLoading ? 'animate-spin' : '' }), isLoading ? 'Sincronizando...' : 'Sincronizar Agora'] }), _jsx("button", { onClick: refresh, disabled: isLoading, className: "flex items-center justify-center gap-2 bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed font-medium transition", title: "Atualizar status", children: _jsx(RefreshCw, { size: 18 }) })] })) }), error && (_jsx("div", { className: "bg-red-50 border border-red-200 text-red-700 p-3 rounded-lg text-sm", children: error.message })), _jsxs("div", { className: "bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm text-blue-700 space-y-2", children: [_jsx("p", { className: "font-medium", children: "Como funciona:" }), _jsxs("ul", { className: "list-disc list-inside space-y-1 text-xs", children: [_jsx("li", { children: "Conecte sua conta Microsoft Teams" }), _jsx("li", { children: "Reuni\u00F5es criadas aparecer\u00E3o automaticamente na agenda" }), _jsx("li", { children: "Sincronize para importar reuni\u00F5es existentes" }), _jsx("li", { children: "Os links das reuni\u00F5es s\u00E3o salvos no campo \"Local\"" })] })] })] }));
}
